# Simple database manager project Adrian Bielec 2020 &copy;
It is a project, which tasks will communicate with database and make work with it easier.

## Something like StrawPool, but in the console
So... I am building here something like strawpoll, the database is creating automaticlly if you only want, if you don't want it. It will not build it.

## What will it do?
Okey, here is pretty beautiful console app, which allow you creating your own polls, giving answer for it and everything will be saved in the SQL server! Whoa amazing!

# Database
*(Password is generated by keepass, so don't worry. I am not using it anymore)*
## Connecting config
Here are basic configuration info
* **Host:** 127.0.0.1
* **Port:** 3306
* **Database Username:** root
* **Database Password:** OcJYGs9zAYvw70180lZn
* **Database Name:** pollapp  

You are able to change it in ***database.h*** file.
## Database tables  


<table>
<thead>
	<tr>
		<th>Name</th>
		<th>Type</th>
		<th>Relation</th>
	</tr>
</thead>
<tbody>
    <tr>
       <td colspan="3" style="text-align:center;"><b>Polls</b></td>
    </tr>
    <tr>
        <td>Id</td>  
        <td>int AI PK</td>
        <td>-</td>
    </tr>
    <tr>
        <td>Title</td>
        <td>varchar(100)</td>
        <td>-</td>
    </tr>
    <tr>
        <td>Description</td>
        <td>varchar(255)</td>
        <td>-</td>
    </tr>
    <tr>
        <td colspan="3" style="text-align:center;"><b>Questions</b></td>
    </tr>
    <tr>
        <td>Id</td>  
        <td>int AI PK</td>
        <td>-</td>
    </tr>
    <tr>
        <td>PollId</td>
        <td>int</td>
        <td><i>Polls(Id)</i></td>
    </tr>
    <tr>
        <td>Type</td>
        <td>int</td>
        <td>-</td>
    </tr>
    <tr>
        <td>RowOrder</td>
        <td>int unsigned</td>
        <td>-</td>
    </tr>
    <tr>
        <td>QuestionText</td>  
        <td>varchar(130)</td>
        <td>-</td>
    </tr>
    <tr>
        <td colspan="3" style="text-align:center;"><b>Available_close_answers</b></td>
    </tr>
    <tr>
        <td>Id</td>
        <td>int AI PK</td>
        <td>-</td>
    </tr>
    <tr>
        <td>RowOrder</td>  
        <td>int unsigned</td>
        <td>-</td>
    </tr>
    <tr>
        <td>QuestionId</td>
        <td>int</td>
        <td><i>Questions(Id)</i></td>
    </tr>
    <tr>
        <td>AnswerText</td>
        <td>varchar(300)</td>
        <td>-</td>
    </tr>
    <tr>
        <td colspan="3" style="text-align:center;"><b>Close_answers_replies</b></td>
    </tr>
    <tr>
        <td>Id</td>
        <td>int AI PK</td>
        <td>-</td>
    </tr>
    <tr>
        <td>PollId</td>  
        <td>int</td>
        <td><i>Polls(Id)</i></td>
    </tr>
    <tr>
        <td>QuestionId</td>
        <td>int</td>
        <td><i>Questions(Id)</i></td>
    </tr>
    <tr>
        <td>AnswerId</td>
        <td>int</td>
        <td><i>Available_close_answers(id)</i></td>
    </tr>
    <tr>
        <td colspan="3" style="text-align:center;"><b>Customer_answers</b></td>
    </tr>
	<tr>
		<td>Id</td>
		<td>int AI PK</td>
		<td>-</td>
	</tr>
	<tr>
		<td>PollId</td>
		<td>int</td>
		<td><i>Polls(id)</i></td>
	</tr>
	<tr>
		<td>QuestionId</td>
		<td>int</td>
		<td><i>Questions(id)</i></td>
	</tr>
	<tr>
		<td>Answer</td>
		<td>varchar(255)</td>
		<td><i>-</i></td>
	</tr>
</tbody>
</table>

***Simple description** available_close_answers is keeping information for allowed answers for close question. Close_answers_replies is an table which is storing question answers data.*

# How to work with it.
Constructor of object doesn't work basiclly. So if you want to start with my application you have to call constructor.  
You can ask why? So... Application is need time to get response from database, every functions which are loading data from database are bools. It allow you to be sure, everything is fine.
## Construct object
```cpp
Database* MyDB;

if(MyDB->ConstructObject())
{
    // Some instructions, everything is fine. You are connected with server and database.
}
```
Remember, you have to include this at the start of your app.
> #include "database.h"

## How to work with app eg.?
* **How to show Poll meta informations:**
```cpp
void ShowHeader(Poll* pPoll)
{
	// static header, which will always showed
	std::cout << pPoll->Title << std::endl;
	std::cout << pPoll->Description << std::endl;
}
```
* **How to show Polls names:**
```cpp
void ShowPolls(Database* PollDB)
{
	int ArrayIndex{ 1 };
	for(auto& Poll: PollDB->GetPolls())
	{
		if (ArrayIndex % 5 != 5) { std::cout << ArrayIndex++ << ". " << Poll.Title << "\t"; }
		else if (ArrayIndex % 5 == 5) { std::cout << ArrayIndex++ << ". " << Poll.Title << std::endl; }
	}
}
```
* **How to work with questions**  
**Showing question text, and inserting data there:** 
```cpp
void LoadAnswersToVariables(Poll* pPoll)
{
	for (auto* Question : pPoll->Questions)
	{
		Question->ShowContent();
		Question->AnswerForQuestion();
	}
}
```
## How to save data into database
When you have done steps before, you can use
>function MyDB->InsertUserAnswer(Question* pQuestion, unsigned short int PollId);

eg.
```cpp
void SendAnswersToDatabase(Poll* pPoll,Database* MyDB)
{
	for (auto* Question : pPoll->Questions)
	{
		MyDB->InsertUserAnswer(Question, pPoll->Id);
	}
}
```
## How to create a new poll
Everything what you have to do it is call to Database method "CreatePoll"
`MyDB->CreatePoll();`

## Poll struct
How does Poll struct does look?
```cpp
struct Poll
{
	// Cannot be undefined
	unsigned short int Id;
	std::string Title;
	std::string Description;
	
	// Can be undefined
	std::vector<Question*> Questions; // Polymorhpics class
};

```


